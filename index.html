<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Digit Recog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
  <canvas id="pad" width="280" height="280" style="border:1px solid #ccc"></canvas>
  <div>
    <button id="clear">Clear</button>
    <button id="predict">Predict</button>
    <span id="out"></span>
  </div>
<script>
const API_BASE = "<YOUR_CLOUD_RUN_URL>"; // e.g., https://digit-recog-api-xxxxx-uw.a.run.app

const c = document.getElementById('pad');
const ctx = c.getContext('2d');
ctx.fillStyle = 'white'; ctx.fillRect(0,0,c.width,c.height);
ctx.lineWidth = 18; ctx.lineCap = 'round'; ctx.strokeStyle = 'black';

let drawing = false;
c.onmousedown = e => { drawing = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); };
c.onmousemove = e => { if(!drawing) return; ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke(); };
c.onmouseup   = () => drawing = false;
c.onmouseleave= () => drawing = false;

document.getElementById('clear').onclick = () => { ctx.fillStyle='white'; ctx.fillRect(0,0,c.width,c.height); };

document.getElementById('predict').onclick = async () => {
  const dataUrl = c.toDataURL('image/png');
  const res = await fetch(`${API_BASE}/predict`, {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ image: dataUrl })
  });
  const json = await res.json();
  document.getElementById('out').textContent = json.prediction !== undefined ? `â†’ ${json.prediction}` : `Error: ${json.error}`;
};
</script>
</body>
</html>
